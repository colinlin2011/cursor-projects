# 历史工作平台文档读取说明

## 当前状态

已按照快速添加指南将两个文档添加到配置文件 `work/fault_diagnosis_guides_config.json`：

1. **历史工作平台文档1**
   - Node Token: `ldxmuDnzIjTSlyRW`
   - URL: `https://zyt.feishu.cn/base/YWDGbSZZKalcnQskTThcSUSXnub?table=ldxmuDnzIjTSlyRW`

2. **历史工作平台文档2**
   - Node Token: `ldxHfyQ1eqCXMji4`
   - URL: `https://zyt.feishu.cn/base/YWDGbSZZKalcnQskTThcSUSXnub?table=ldxHfyQ1eqCXMji4`

## 问题分析

这两个文档位于多维表格内部，无法通过常规的Wiki API或文档API获取，原因：

1. **不在Wiki知识库中**：这些文档不是Wiki知识库的节点，无法通过`get_wiki_node` API获取
2. **不是独立的文档**：这些文档可能是多维表格内部的文档块，需要通过多维表格的特殊API获取
3. **URL参数说明**：URL中的`table`参数值可能是view_id或文档块的标识，而不是标准的node_token

## 已尝试的方法

### 方法1：作为Wiki节点获取
- 使用`get_wiki_node` API
- 结果：失败（错误码131005: not found）

### 方法2：通过多维表格API获取
- 获取多维表格信息成功，但无法直接获取内部文档

### 方法3：直接使用node_token作为document_id
- 使用`get_document_blocks` API
- 结果：失败（错误码1770001: invalid param）

## 可能的解决方案

### 方案1：通过多维表格块API获取（需要确认）

多维表格内部可能包含文档块，需要通过多维表格的块API获取。但目前飞书开放平台的多维表格API主要支持数据表操作，可能不直接支持获取内部文档块。

### 方案2：通过文档字段获取

如果这些文档是通过多维表格的"文档"字段类型存储的，可能需要：
1. 先获取包含文档字段的数据表
2. 读取记录中的文档字段值
3. 通过文档字段中的document_id获取文档内容

### 方案3：手动导出

如果API方式无法解决，可以：
1. 在飞书多维表格中手动打开这些文档
2. 使用浏览器的"打印"功能或"导出"功能
3. 将内容整理后手动添加到缓存

## 配置文件状态

文档已添加到配置文件，系统会在以下情况自动尝试加载：
- 运行 `sync_fault_guides.py` 时
- 运行 `auto_sync_all.py` 时
- 使用 `FaultGuideReader` 时

## 后续建议

1. **确认文档类型**：确认这些文档的具体类型和访问方式
2. **查看飞书API文档**：查找多维表格内部文档的专门API
3. **联系飞书技术支持**：如果确实需要API方式访问，可以咨询飞书技术支持
4. **临时方案**：如果需要立即使用，可以手动导出文档内容

## 相关文件

- **配置文件**：`work/fault_diagnosis_guides_config.json`
- **读取脚本**：`capabilities/skills/skills/load_bitable_docs.py`
- **同步脚本**：`capabilities/skills/skills/sync_fault_guides.py`
- **缓存目录**：`work/fault_diagnosis_cache/guides/`
