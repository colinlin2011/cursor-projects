# Word模板创建指南

## 概述

本指南将帮助您创建一个专业的Word模板（reference.docx），用于Pandoc将Markdown文件转换为Word格式时使用。

## 创建步骤

### 步骤1：创建新文档

1. 打开Microsoft Word
2. 创建新空白文档
3. 保存为`reference.docx`（暂时保存到任意位置，稍后移动到模板目录）

### 步骤2：设置页面格式

#### 2.1 设置页边距
1. 点击 **页面布局** → **页边距** → **自定义边距**
2. 设置以下值：
   - 上：2.54cm
   - 下：2.54cm
   - 左：3.17cm
   - 右：3.17cm
3. 点击 **确定**

#### 2.2 设置纸张大小
1. 点击 **页面布局** → **纸张大小**
2. 选择 **A4**（默认）

### 步骤3：设置页眉

1. 双击页面顶部进入页眉编辑模式
2. 在页眉左侧添加：
   - 文档标题或公司名称
   - 字体：宋体，10pt
3. 在页眉右侧添加：
   - 日期或版本号
   - 字体：宋体，10pt
4. 双击正文区域退出页眉编辑

**示例页眉内容**：
```
左侧：功能安全文档                   右侧：2026-01-13
```

### 步骤4：设置页脚

1. 双击页面底部进入页脚编辑模式
2. 插入页码：
   - 点击 **插入** → **页码** → **页面底端** → **普通数字2**（居中）
   - 或选择其他页码格式
3. 设置页码格式：
   - 右键点击页码 → **设置页码格式**
   - 选择格式：1, 2, 3... 或 - 1 - 等
4. 字体：宋体，10pt
5. 双击正文区域退出页脚编辑

### 步骤5：定义样式

#### 5.1 修改标题1样式
1. 点击 **开始** → **样式** → 右键点击 **标题1** → **修改**
2. 设置格式：
   - **字体**：
     - 中文字体：微软雅黑
     - 英文字体：Times New Roman
     - 字号：16pt
     - 加粗：是
   - **段落**：
     - 对齐方式：左对齐
     - 段前：12pt
     - 段后：6pt
     - 行距：单倍行距
3. 点击 **确定**

#### 5.2 修改标题2样式
1. 右键点击 **标题2** → **修改**
2. 设置格式：
   - **字体**：
     - 中文字体：微软雅黑
     - 英文字体：Times New Roman
     - 字号：14pt
     - 加粗：是
   - **段落**：
     - 对齐方式：左对齐
     - 段前：10pt
     - 段后：4pt
     - 行距：单倍行距
3. 点击 **确定**

#### 5.3 修改标题3样式
1. 右键点击 **标题3** → **修改**
2. 设置格式：
   - **字体**：
     - 中文字体：微软雅黑
     - 英文字体：Times New Roman
     - 字号：12pt
     - 加粗：是
   - **段落**：
     - 对齐方式：左对齐
     - 段前：8pt
     - 段后：2pt
     - 行距：单倍行距
3. 点击 **确定**

#### 5.4 修改正文样式
1. 右键点击 **正文** → **修改**
2. 设置格式：
   - **字体**：
     - 中文字体：宋体
     - 英文字体：Times New Roman
     - 字号：10.5pt（或12pt）
   - **段落**：
     - 对齐方式：两端对齐
     - 首行缩进：2字符
     - 段前：0pt
     - 段后：0pt
     - 行距：1.5倍行距
3. 点击 **确定**

#### 5.5 创建列表样式（可选）
1. 点击 **开始** → **多级列表** → **定义新的多级列表**
2. 设置列表格式：
   - 级别1：1. 2. 3.
   - 级别2：1.1 1.2 1.3
   - 级别3：1.1.1 1.1.2 1.1.3
3. 点击 **确定**

### 步骤6：添加示例内容（重要）

为了确保Pandoc能正确识别样式，建议在模板中添加一些示例内容：

1. 在文档中输入以下内容：
   ```
   标题1示例
   
   这是正文示例。正文应该使用正文样式。
   
   标题2示例
   
   这是另一个正文段落。
   
   标题3示例
   
   这是列表示例：
   - 项目1
   - 项目2
   - 项目3
   ```

2. 应用样式：
   - 选中"标题1示例"，应用 **标题1** 样式
   - 选中"这是正文示例..."，应用 **正文** 样式
   - 选中"标题2示例"，应用 **标题2** 样式
   - 选中"这是另一个正文段落"，应用 **正文** 样式
   - 选中"标题3示例"，应用 **标题3** 样式
   - 选中列表项，应用 **列表段落** 样式

### 步骤7：保存模板

1. 点击 **文件** → **另存为**
2. 选择保存位置：`capabilities/skills/local-tools/templates/`
3. 文件名：`reference.docx`
4. 文件类型：Word文档 (*.docx)
5. 点击 **保存**

### 步骤8：验证模板

1. 创建一个测试Markdown文件（test.md）：
   ```markdown
   # 测试标题1
   
   这是测试正文。
   
   ## 测试标题2
   
   这是另一个段落。
   
   ### 测试标题3
   
   - 列表项1
   - 列表项2
   ```

2. 使用Pandoc转换：
   ```powershell
   cd capabilities\skills\local-tools
   .\pandoc-wrapper.ps1 -Action word -InputFile "test.md"
   ```

3. 检查生成的Word文档：
   - 样式是否正确应用
   - 页眉页脚是否正确显示
   - 格式是否符合要求

## 样式参考表

| 样式名称 | 字体 | 字号 | 加粗 | 段前 | 段后 | 行距 |
|---------|------|------|------|------|------|------|
| 标题1 | 微软雅黑/Times New Roman | 16pt | 是 | 12pt | 6pt | 单倍 |
| 标题2 | 微软雅黑/Times New Roman | 14pt | 是 | 10pt | 4pt | 单倍 |
| 标题3 | 微软雅黑/Times New Roman | 12pt | 是 | 8pt | 2pt | 单倍 |
| 正文 | 宋体/Times New Roman | 10.5pt | 否 | 0pt | 0pt | 1.5倍 |

## 常见问题

### Q1: 为什么需要示例内容？
**A**: Pandoc需要从模板中识别样式定义。如果模板是空白的，Pandoc可能无法正确应用样式。

### Q2: 可以自定义样式名称吗？
**A**: 可以，但需要确保Markdown中的标题层级（#、##、###）能正确映射到对应的样式。建议使用标准的"标题1"、"标题2"、"标题3"名称。

### Q3: 如何创建多个模板？
**A**: 可以创建多个模板文件，如`report-template.docx`、`proposal-template.docx`等。使用时通过`-TemplateFile`参数指定。

### Q4: 模板中的页眉页脚会被保留吗？
**A**: 是的，Pandoc会将模板中的页眉页脚应用到转换后的文档中。

## 高级设置

### 添加公司Logo
1. 在页眉中插入图片
2. 调整图片大小和位置
3. 保存模板

### 自定义表格样式
1. 插入一个示例表格
2. 应用表格样式
3. 保存模板

### 添加水印
1. 设计 → 水印 → 自定义水印
2. 设置水印内容
3. 保存模板

## 参考资源

- [Pandoc官方文档](https://pandoc.org/MANUAL.html)
- [Pandoc Word模板说明](https://pandoc.org/MANUAL.html#option--reference-doc)
- [Microsoft Word样式指南](https://support.microsoft.com/office)
