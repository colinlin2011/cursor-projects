# -*- coding: utf-8 -*-
"""
FMEA导入配置

定义字段映射关系、选项值映射等配置
"""

# FMEA在线表格字段到多维表格字段的映射关系
# 支持多种字段名变体（因为不同FMEA表格的字段名可能略有差异）
FIELD_MAPPING = {
    # 功能/子功能相关
    "功能": "关联功能",
    "子功能": "关联功能",
    "功能名称": "关联功能",
    "子功能名称": "关联功能",
    "功能描述": "关联功能",
    "子功能描述": "关联功能",
    
    # 失效模式
    "失效模式": "实际识别的失效模式",
    "失效模式描述": "实际识别的失效模式",
    "Failure Mode": "实际识别的失效模式",
    "失效模式假设": "实际识别的失效模式",
    
    # 失效影响
    "失效影响": "潜在失效影响",
    "失效影响描述": "潜在失效影响",
    "潜在失效影响": "潜在失效影响",
    "Failure Effect": "潜在失效影响",
    "影响": "潜在失效影响",
    
    # 失效原因
    "失效原因": "导致失效的原因",
    "失效原因描述": "导致失效的原因",
    "导致失效的原因": "导致失效的原因",
    "Failure Cause": "导致失效的原因",
    "原因": "导致失效的原因",
    
    # 引导词
    "引导词": "引导词",
    "Guide Word": "引导词",
    
    # 分析日期
    "分析日期": "分析日期",
    "日期": "分析日期",
    "Date": "分析日期",
    "分析时间": "分析日期",
    
    # 分析责任人
    "分析责任人": "分析责任人",
    "责任人": "分析责任人",
    "负责人": "分析责任人",
    "分析人": "分析责任人",
    "Responsible": "分析责任人",
    
    # ASIL等级（可能需要从其他字段推导）
    "ASIL": "ASIL",
    "ASIL等级": "ASIL",
    "ASIL Level": "ASIL",
    
    # 安全机制（可能有多个字段）
    "安全机制": "安全机制(SPF)(UE1)",
    "Safety Mechanism": "安全机制(SPF)(UE1)",
    "SPF安全机制": "安全机制(SPF)(UE1)",
    "LF安全机制": "安全机制（潜伏）(UE1)",
    
    # 分析状态
    "分析状态": "分析状态",
    "状态": "分析状态",
    "Status": "分析状态",
    
    # 频度
    "频度": "频度(F)",
    "频度(F)": "频度(F)",
    "Frequency": "频度(F)",
    "F": "频度(F)",
    
    # MSR有效性
    "MSR有效性": "MSR有效性(M)",
    "MSR有效性(M)": "MSR有效性(M)",
    "M": "MSR有效性(M)",
    "有效性": "MSR有效性(M)",
}

# 引导词选项值映射（FMEA表格中的值 -> 多维表格中的选项值）
GUIDE_WORD_MAPPING = {
    "无": "无",
    "缺失": "缺失",
    "错误": "错误",
    "延迟": "延迟",
    "过早": "过早",
    "过晚": "过晚",
    "遗漏": "遗漏",
    "No": "无",
    "Missing": "缺失",
    "Wrong": "错误",
    "Late": "延迟",
    "Early": "过早",
    "Omitted": "遗漏",
}

# 分析状态选项值映射
ANALYSIS_STATUS_MAPPING = {
    "已完成": "已完成",
    "进行中": "进行中",
    "未开始": "未开始",
    "待审核": "待审核",
    "已完成": "已完成",
    "Completed": "已完成",
    "In Progress": "进行中",
    "Not Started": "未开始",
    "Pending": "待审核",
}

# 频度选项值映射
FREQUENCY_MAPPING = {
    "1": "1",
    "2": "2",
    "3": "3",
    "4": "4",
    "5": "5",
    "6": "6",
    "7": "7",
    "8": "8",
    "9": "9",
    "10": "10",
}

# MSR有效性选项值映射
MSR_EFFECTIVENESS_MAPPING = {
    "高": "高",
    "中": "中",
    "低": "低",
    "High": "高",
    "Medium": "中",
    "Low": "低",
    "H": "高",
    "M": "中",
    "L": "低",
}

# ASIL等级选项值映射
ASIL_LEVEL_MAPPING = {
    "QM": "QM",
    "A": "A",
    "B": "B",
    "C": "C",
    "D": "D",
    "ASIL A": "A",
    "ASIL B": "B",
    "ASIL C": "C",
    "ASIL D": "D",
}

# 需要跳过的字段（公式字段、自动计算字段等）
SKIP_FIELDS = [
    "分析ID",
    "所属父元素",
    "架构元素",
    "失效模式假设",
    "风险矩阵坐标",
    "关联需求数量",
]

# 日期格式列表（用于解析日期）
DATE_FORMATS = [
    "%Y-%m-%d",
    "%Y/%m/%d",
    "%d/%m/%Y",
    "%d-%m-%Y",
    "%Y年%m月%d日",
    "%Y.%m.%d",
]
