# 重新授权获取完整权限

## 问题说明

当前访问令牌缺少 `base:record:read` 权限，导致无法读取"缺陷问题闭环表"等数据表的记录。

## 解决方案

### 步骤1：使用包含完整权限的授权URL

访问以下授权URL（已包含所有必要权限）：

```
https://open.feishu.cn/open-apis/authen/v1/index?app_id=cli_a9c92ca516f99bd9&redirect_uri=https://open.feishu.cn/app/cli_a9c92ca516f99bd9/auth&scope=bitable:app%20bitable:app:readonly%20base:app:read%20base:field:read%20base:view:read%20base:record:read
```

或者使用脚本自动打开：

```powershell
cd "d:\Users\colin.lin\.cursor\cursor-projects\study-systems\ai-as-me-workplace\capabilities\skills\skills"
python get_user_token_for_bitable.py
```

### 步骤2：完成授权

1. 在浏览器中完成授权
2. 确保勾选所有权限（特别是 `base:record:read`）
3. 授权完成后，从浏览器URL中获取 `code` 参数

### 步骤3：获取新的访问令牌

将授权码（code）提供给脚本，获取新的 `user_access_token`。

### 步骤4：设置环境变量并重新同步

```powershell
$env:FEISHU_USER_ACCESS_TOKEN="your_new_token_here"
cd "d:\Users\colin.lin\.cursor\cursor-projects\study-systems\ai-as-me-workplace\capabilities\skills\skills"
python sync_functional_safety_bitable.py
```

## 所需权限列表

- `bitable:app` - 多维表格应用权限
- `bitable:app:readonly` - 多维表格只读权限
- `base:app:read` - 读取应用信息
- `base:field:read` - 读取字段信息
- `base:view:read` - 读取视图信息
- `base:record:read` - **读取记录信息（新增，必需）**

## 注意事项

1. 某些数据表可能有特殊的访问控制，需要确保你的账号有访问权限
2. 如果仍然遇到权限问题，可能需要联系多维表格管理员，将应用添加为协作者
3. 访问令牌有效期约2小时，过期后需要重新获取
