获取指定的关联工作项列表（单空间）

该接口用于获取与指定工作项实例存在工作项关联的工作项实例列表。对应的权限申请在权限管理-工作项实例分类下，相关功能介绍详见​权限管理。​

如获取工作项关联为需求和缺陷的关联字段（relation_key），可查询该需求工作项实例下绑定的缺陷列表：​

​

​​​

​

​

请求说明​

  * 请求方式：POST​



  * 请求地址：/open_api/:project_key/work_item/:work_item_type_key/:work_item_id/search_by_relation​



请求参数​

Header​

接口调用的 Header 配置详见 [Header](../1p8d7djs/4bsmoql6#a8e43b86)。​

Path​

​

参数| 类型| 是否必须| 说明  
---|---|---|---  
project_key| string| 必须| 空间 ID（project_key），或者空间域名（simple_name）。

  * 空间 ID（project_key），在飞书项目空间双击空间名称获取。
  * 空间域名（simple_name），simple_name 一般在飞书项目空间 URL 中获取。例如空间 URL 为 “https://project.feishu.cn/doc/overview”，则 simple_name为 “doc”。

  
work_item_type_key| string| 必须| 工作项类型，创建工作项时自动生成，通过[获取空间下工作项类型](../1p8d7djs/3pjp854w)接口获取，需要与 work_item_id对应实例匹配。  
work_item_id| string| 必须| 工作项实例 ID，在工作项实例详情中，展开右上角 **··· > ID**获取。  
  
​

Body​

​

参数| 类型| 是否必须| 说明  
---|---|---|---  
relation_work_item_type_key| string| 必须| 关联的工作项类型。  
relation_key| string| 必须| 关联关系 key。两个工作项之间通过某个关联字段绑定，填入该字段 key 或对接标识即可。  
relation_type| int32| 可选| 关联关系的类型，用于指定关联字段的标识方式。支持的取值如下所示。

  * 0：关联字段 ID；
  * 1：关联字段对接标识。默认值为 0。

  
page_size| int64| 可选| 每页返回的工作项数量，最大值为 50。排序方式为先按照反向在前正向在后，再按照工作项 ID 排序。  
若查询的数据超过 2000 个，即使设置了分页依旧会报错。  
page_num| int64| 可选| 分页页码，从 1 开始，默认值为 1。  
  
​

返回参数​

​

参数| 类型| 说明  
---|---|---  
data| list<object>| 返回的工作项数据列表，遵循[WorkItemInfo](../1p8d7djs/1x1d372l#a16fbe28)结构规范  
pagination| object| 分页信息，包含当前查询的数据总数、当前页数和每页数据量。  
err| object| 请求成功时返回空值，请求失败时返回实际错误信息。  
err_msg| string| 请求成功时返回空值，请求失败时返回实际错误信息。  
err_code| int32| 请求成功时返回0，请求失败返回实际错误码。  
  
​

请求示例​

请求路径：POST /open_api/658b9f05809f644b****/work_item/story/123456****/search_by_relation​

​

JSON

复制

{​

"relation_work_item_type_key": "issue",​

"relation_key":"_field_linked_story",​

"page_size":10,​

"page_num":1,​

"relation_type":0 ​

}

​

返回示例​

请求成功示例

错误返回示例

​

JSON

复制

{​

"data":[​

{​

"id":1,​

"name":"item1",​

"work_item_type_key":"issue",​

"project_key":"658b9f05809f644b****",​

"simple_name":"test",​

"template_type":"control",​

"pattern":"Node",​

"sub_stage":"started", //仅早期实例涉及，已弃用​

"work_item_status": {},​

"current_node":[​

{​

"id":"state_1",​

"name":"node1",​

"owners":[​

"701251455513382****"​

]​

}​

],​

"created_by":"700914671966122****",​

"updated_by":"700914671966122****",​

"created_at":1633776613033,​

"updated_at":1633776613033,​

"fields":[​

{​

"field_alias": "",​

"field_key": "aborted",​

"field_type_key": "aborted",​

"field_value": {​

"is_aborted": false, "reason": ""​

}​

},​

{​

"field_alias": "",​

"field_key": "role_owners",​

"field_type_key": "role_owners",​

"field_value": [​

{​

"owners": [​

"701251455518415****"​

],​

"role": "uiouiouio"​

},​

{​

"owners": null,​

"role": "test"​

},​

{​

"owners": null,​

"role": "tt"​

}​

]​

}​

],​

}​

],​

"err": {},​

"err_msg": "",​

"err_code": 0,​

"pagination": {​

"page_num": 1,​

"page_size": 10,​

"total": 1​

}​

}

​

​

错误码​

以下列出了该接口相关的错误码信息，若需查看更多通用错误码说明，参见 [Open API 错误码](../1p8d7djs/5aueo3jr)。​

​

err_code| err_msg| err.code| err.msg| 说明  
---|---|---|---|---  
20055| "Search Result Bigger Than 2000| 20055| 20055| 查询结果超过2000个，请重新设置筛选条件。  
30018| Config Not Found| 30018| RelationKey Not Exist In Configuration| 传入的 relation_key 不存在，可通过调用[获取空间关联规则列表](/1p8d7djs/4vo9hsuj)接口获取该 ID。  
20060| WorkItemTypeKey Or RelationWorkItemTypeKey Is Not Match In Field Configuration| 20060| WorkItemTypeKey Or RelationWorkItemTypeKey Is Not Match In Field Configuration| 字段配置异常，请确认 relation_key 是否为关联工作项字段  
50005| Internal Server Error| 50005| Internal Server Error| 字段所属关系异常，请确认 relation_key 是否为关联工作项字段  
30018| RelationKey Not Exist In Configuration| 30018| RelationKey Not Exist In Configuration| 传入的 relation_key 不存在，可通过调用[获取空间关联规则列表](/1p8d7djs/4vo9hsuj)接口获取该 ID。  
  
​

上一篇

获取指定的工作项列表（全局搜索）

下一篇

获取工作项详情
