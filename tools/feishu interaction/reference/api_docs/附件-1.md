添加附件

该接口用于在指定工作项的一个附件类型字段中添加附件，对应的插件应用效果可参考​上传附件。对应的权限申请在权限管理-工作项实例分类下，相关功能介绍详见 ​权限管理。​

注意事项​

1.

接口响应成功，页面查看无文件的情况，排查时需检查 form 表单-file 字段内容。当前情况下 file 为空，不拦截。​




2.

遇到浏览器无法展示附件预览的情况，需检查上传时的文件 MimeType 设置，填写与文件类型匹配的 MimeType。如 jpeg 格式图片：image/jpeg，mp4 格式音频：audio/mp4，mp4 格式视频：video/mp4 等。​




3.

工作项附件类型字段的附件数量限制为50个，超过50个时，新增附件会失败。​




请求说明​

  * 请求方式：POST​



  * 请求地址：/open_api/:project_key/work_item/:work_item_type_key/:work_item_id/file/upload​



请求参数​

Header​

接口调用的 Header 配置详见 [Header](../1p8d7djs/4bsmoql6#a8e43b86)。​

Path​

​

参数| 类型| 是否必须| 说明  
---|---|---|---  
project_key| string| 必须| 空间 ID（project_key），或者空间域名（simple_name）。

  * 空间 ID（project_key），在飞书项目空间双击空间名称获取。
  * 空间域名（simple_name），simple_name 一般在飞书项目空间 URL 中获取。例如空间 URL 为 “https://project.feishu.cn/doc/overview”，则 simple_name为 “doc”。

  
work_item_type_key| string| 必须| 工作项类型，系统自动生成，可通过[获取空间下工作项类型](../1p8d7djs/3pjp854w)接口获取  
work_item_id| string| 必须| 工作项实例 ID，在工作项实例详情中，展开右上角 **··· > ID**获取。  
  
​

Body​

​

参数| 类型| 是否必须| 说明  
---|---|---|---  
file| file| 必须| 附件，目前只支持同时传一个附件，最大支持100M  
field_key| string| 可选| 上传附件字段的唯一标识，用于指定附件上传的目标字段。与 field_alias参数二选一传入即可。  
field_alias| string| 可选| 上传附件字段的对接标识，用于指定附件上传的目标字段。与 field_key参数二选一传入即可。  
index| string| 可选| 复合字段适用，用于指定数组下标。  
  
​

返回参数​

​

参数| 类型| 说明  
---|---|---  
err| object| 请求成功时返回空值，请求失败时返回实际错误信息。  
err_msg| string| 请求成功时返回空值，请求失败时返回实际错误信息。  
err_code| int32| 请求成功时0，请求失败返回实际错误码。  
  
​

请求示例​

上传附件

在复合字段中上传

请求路径：POST /open_api/68382b399de4b0ec6c5xxxx/work_item/story/643711xxxx/file/upload​

​

JSON

复制

{​

"file": "example.pdf", // form-data 表单方式上传，传入的是文件二进制流​

"field_key": "field_123",​

"field_alias": "multi_text",​

}

​

​

返回示例​

请求成功返回

错误返回示例

​

JSON

复制

{​

"err": {},​

"err_msg": "",​

"err_code": 0​

}

​

​

错误码​

以下列出了该接口相关的错误码信息，若需查看更多通用错误码说明，参见 [Open API 错误码](../1p8d7djs/5aueo3jr)。​

​

err_code| err_msg| err.code| err.msg| 说明  
---|---|---|---|---  
1000050255| ErrAPIProjectNotFound| 1000050255| Project Not Found| project_key 填写不正确。  
1000050174| ErrAPIUploadFileSizeUpperLimit| 1000050174| Uploaded File Size Limit 100M| 文件大小超过限制 100M  
1000050190| ErrAPIUnSetForm| 1000050190| Request Form Is Null| 表单参数无效  
1000050262| ErrAPIUploadError| 1000050262| Upload File Fail| 上传失败  
  
​

上一篇

删除子任务

下一篇

上传文件或富文本图片
