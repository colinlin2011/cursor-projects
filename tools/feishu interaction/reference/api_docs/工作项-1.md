获取指定的工作项列表（单空间）

该接口用于在指定空间，搜索符合请求参数中传入条件的工作项实例。对应的权限申请在 权限管理-工作项 分类下，相关功能介绍详见​权限管理。常见问题可参考​工作项列表。​

请求说明​

  * 请求方式：POST​



  * 请求地址：/open_api/:project_key/work_item/filter​



请求参数​

Header​

接口调用的 Header 配置详见 [Header](../1p8d7djs/4bsmoql6#a8e43b86)。​

Path​

​

参数| 类型| 是否必须| 说明  
---|---|---|---  
project_key| string| 必须| 空间 ID（project_key），或者空间域名（simple_name）。

  * 空间 ID（project_key），在飞书项目空间双击空间名称获取。
  * 空间域名（simple_name），simple_name 一般在飞书项目空间 URL 中获取。例如空间 URL 为 “https://project.feishu.cn/doc/overview”，则 simple_name为 “doc”。

  
  
​

Body​

​

参数| 类型| 是否必须| 说明  
---|---|---|---  
work_item_name| string| 可选| 工作项名称(支持模糊搜索)。  
user_keys| list<string>| 可选| 用户 user_key 列表（支持搜索创建人/关注人/角色人员为该用户的相关工作项）。  
work_item_ids| list<int64>| 可选| 工作项 ID 列表，在工作项实例中右上角单击 **··· > ID** 获取。  
work_item_type_keys| list<string>| 必须| 工作项类型列表，可通过[获取空间下工作项类型](../1p8d7djs/3pjp854w)获取。  
created_at| object| 可选| 创建时间（支持时间区间查询，可不传截止时间，代表至今）。  
updated_at| object| 可选| 更新时间（支持时间区间查询，可不传截止时间，代表至今）。  
sub_stages| list<string>| 可选| 需求工作项状态列表，**已合并到 work_item_status** **非需求不可使用，建议直接使用 work_item_status** 。可从以下途径获取：

  1. [获取字段信息](../1p8d7djs/3tsposa2)接口中 work_item_status 的 options 中获取，选择对应的 value
  2. [获取创建工作项元数据](../1p8d7djs/2jhqmwhn)接口中的 work_item_status 字段的options 中获取，选择对应的 value

  
work_item_status| list<object>| 可选| 工作项状态列表，遵循[WorkItemStatus](../1p8d7djs/1x1d372l#9b44f95f)结构规范，用于筛选当前处于指定状态的工作项实例。可通过以下方式获取状态值：

  * 调用[获取字段信息](../1p8d7djs/3tsposa2)接口，从 work_item_status 字段的 options 中获取对应 value；
  * 调用[获取创建工作项元数据](../1p8d7djs/2jhqmwhn)接口，从 work_item_status 字段的 options 中获取对应 value。

  
businesses| list<string>| 可选| 业务线列表，可从[获取空间下业务线详情](../1p8d7djs/55tfjp4z)接口获取  
priorities| list<string>| 可选| 优先级列表，可从[获取字段信息](../1p8d7djs/3tsposa2)中 priority 字段的 options中获取具体的优先级值。  
tags| list<string>| 可选| 用于筛选工作项的标签列表，可在[获取字段信息](../1p8d7djs/3tsposa2)中 tags 字段的 options中获取。  
search_id| string| 可选| 搜索id，可从[open()](../1p8d7djs/5msoct85#95369ca7)中 callback 中的 result 中获取。  
page_num| int64| 可选| 分页页码，从1开始，默认为1。  
page_size| int64| 可选| 每页返回的数据条数，最大值为 200。  
分页设置不能控制总返回数量，查询结果超过 20w 会报错。  
expand| object| 可选| 额外参数。  
  
​

返回参数​

​

参数| 类型| 说明  
---|---|---  
data| list<object>| 由于搜索引擎限制，最多只能查询到20w条数据，超过请自行用过滤条件（比如时间条件）减少匹配的工作项数目。  
pagination| object| 分页信息  
err| object| 请求成功时返回空值，请求失败时返回实际错误信息。  
err_msg| string| 请求成功时返回空值，请求失败时返回实际错误信息。  
err_code| int32| 请求成功时返回0，请求失败返回实际错误码。  
  
​

请求示例​

查询指定的工作项列表

带 expand 参数查询

请求路径：POST /open_api/648348096840xxxx/work_item/filter​

​

JSON

复制

{​

"work_item_name": "工作项名称",​

"user_keys": [​

"xxx"​

],​

"work_item_ids": [​

xxx​

],​

"work_item_type_keys": [​

"story"​

],​

"created_at": {​

"end": 1753933694380,​

"start": 1753933694372​

},​

"updated_at": {​

"end": 1753933694380,​

"start": 1753933694372​

},​

"sub_stages": [ // 建议直接使用work_item_status​

"xxx"​

],​

"businesses": [​

"xxx"​

],​

"priorities": [​

"xxx"​

],​

"tags": [​

"xxx"​

],​

"page_num": 1,​

"page_size": 10,​

"work_item_status": [​

{​

"state_key": "started",​

"updated_at": xxx, // 节点流不支持​

"updated_by": "xxx", // 节点流不支持​

"is_init_state": true, // 节点流不支持​

"is_archived_state": false // 节点流不支持​

}​

],​

"search_id": "xxx"​

}

​

​

返回示例​

查询指定的工作项列表

带 expand 参数查询

错误返回示例

​

JSON

复制

{​

"data":[ ​

{​

"id":1,​

"name":"item1",​

"work_item_type_key":"story",​

"project_key":"60acd5610444ba031b503055",​

"simple_name":"test",​

"template_type":"control",​

"pattern":"Node",​

"sub_stage":"started",​

"work_item_status": {},​

"current_nodes":[​

{​

"id":"state_1",​

"name":"node1",​

"owners":[​

"7012514555133820947"​

]​

}​

],​

"state_times": [ //节点时间​

{​

"end_time": 1654156400805,​

"name": "开始",​

"start_time": 1654156400804,​

"state_key": "started"​

},​

{​

"end_time": 0,​

"name": "节点表单",​

"start_time": 1654156400805,​

"state_key": "doing"​

}​

],​

"created_by":"7009146719661228031",​

"updated_by":"7009146719661228031",​

"created_at":1633776613033,​

"updated_at":1633776613033,​

"fields":[​

{​

"field_alias": "",​

"field_key": "aborted",​

"field_type_key": "aborted",​

"field_value": {​

"is_aborted": false, "reason": ""​

}​

},​

{​

"field_alias": "",​

"field_key": "role_owners",​

"field_type_key": "role_owners",​

"field_value": [​

{​

"owners": [​

"7012514555184152596"​

],​

"role": "uiouiouio"​

},​

{​

"owners": null,​

"role": "test"​

},​

{​

"owners": null,​

"role": "tt"​

}​

]​

}​

],​

}​

],​

"err": {},​

"err_msg": "",​

"err_code": 0,​

"pagination": {​

"page_num": 1,​

"page_size": 10,​

"total": 1​

}​

}

​

​

错误码​

以下列出了该接口相关的错误码信息，若需查看更多通用错误码说明，参见 [Open API 错误码](../1p8d7djs/5aueo3jr)。​

​

err_code| err_msg| err.code| err.msg| 说明  
---|---|---|---|---  
50006| Es searching too many docs| 50006| too many docs| 查询数量超过20w，请增加筛选条件减少数量  
20003| Wrong WorkItemType Param| 20003| work_item_type_keys should not empty| 

  * 获取指定的工作项列表：work_item_type_keys 未填
  * 目标工作项为状态流，但是设置了 expand 参数{ "need_workflow":true}

  
20013| Invalid Time Interval| 20013| Invalid Time Interval| 获取指定的工作项列表：时间相关参数，不是毫秒时间戳(13位数字)  
30005| WorkItem Not Found| 30005| WorkItem Not Found| 工作项未找到，可能是工作项已删除、查询的工作项 ID 不正确、查询的工作项类型和工作项 ID 不匹配  
20005| Missing Param| 20005| searchid is invalid| 必填的请求参数未填  
20004| Search User Limit| 20004| Search User Limit| 获取指定的工作项列表 user_keys 超过最大10的限制  
30014| WorkItemTypeKey Not Found| 30014| WorkItemTypeKey Not Found Or No Permission| 工作项类型不存在或者没有权限  
  
​

上一篇

获取空间详情

下一篇

获取指定的工作项列表（跨空间）
