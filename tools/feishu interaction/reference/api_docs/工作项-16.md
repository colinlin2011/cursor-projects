获取工作项操作记录

该接口用于获取指定空间下的多个工作项实例的操作记录，包括一个工作项实例（如一个需求）的操作记录。工作项实例是一个具体的事例，例如一个已经创建的需求、缺陷、项目等，详见​名词解释。对应的权限申请在权限管理-工作项实例分类下，相关功能介绍详见 ​权限管理。​

注意

不支持查询2024年7月2日之前的历史记录。​

​

​

请求说明​

  * 请求方式：POST​



  * 请求地址：/open_api/op_record/work_item/list​



请求参数​

Header​

接口调用的 Header 配置详见 [Header](../1p8d7djs/4bsmoql6#a8e43b86)。​

Body​

​

参数| 类型| 是否必须| 说明  
---|---|---|---  
project_key| string| 必须| 空间 ID（project_key），在飞书项目空间双击空间名称获取。  
work_item_ids| list<int64>| 必须| 需要查询的工作项 ID 列表，最大值50。  
start_from| string| 可选| 分页参数，初次请求无需设置，下次请求使用上次请求返回的 start_from。  
operator| list<string>| 可选| 操作者的值，用于筛选实例下对应操作者的操作记录：

  1. 操作者类型为user时，使用用户的 user_key；
  2. 操作者类型为auto时，使用自动化规则的 ID。

  
operator_type| list<string>| 可选| 操作者类型，用于标识操作记录的触发来源。支持的取值如下所示。

  * user：用户操作；
  * auto：自动化规则触发操作；
  * system：系统触发操作；
  * calc_field：计算字段触发操作；
  * plugin：插件操作；
  * others：其他触发来源（如空间关联规则）。

  
source_type| list<string>| 可选| 操作渠道类型，用于标识操作记录的来源渠道。支持的取值如下所示。

  * auto：来自自动化规则渠道；
  * plugin：来自插件渠道。

  
source| list<string>| 可选| 操作渠道值，用于标识操作记录的具体来源。

  * 当 source_type 为 auto 时，使用自动化规则的 ID；
  * 当 source_type 为 plugin时，使用插件的 ID。

  
operation_type| list<string>| 可选| 操作动作类型

  * modify 
    * 修改字段值
    * 修改节点属性：包括负责人、参与人、估分、排期、实际工时等
    * 修改子任务属性：包括负责人、估分、排期等
    * 修改角色与人员
    * 修改评论
    * 修改负责人的属性：包括节点 负责人的排期、估分、实际工时
  * create 
    * 创建工作项
    * 创建子任务
  * delete 
    * 删除工作项
    * 删除子任务
  * terminate 
    * 终止工作项
  * restore 
    * 恢复工作项
  * complete 
    * 完成节点
    * 完成节点子任务
  * rollback 
    * 回滚节点子任务
    * 回滚到节点
  * add 
    * 实例新增节点
  * remove 
    * 实例移除节点

  
start| int64| 可选| 开始时间，毫秒级时间戳，与 end参数配合使用以限定查询时间范围，最长支持 7 天。  
end| int64| 可选| 结束时间，毫秒级时间戳，与 start参数配合使用以限定查询时间范围，最长支持 7 天。  
op_record_module| list<string>| 可选| 操作记录模块。

  * work_item_mod: 实例
  * node_mod: 节点
  * sub_task_mod: 子任务
  * field_mod: 字段
  * role_and_user_mod: 角色与人员
  * baseline_mod: 基线

  
page_size| int64| 可选| 每页数据条数，最大200。未指定时默认为50。分页设置不能够控制返回数量。  
  
​

返回参数​

​

参数| 类型| 说明  
---|---|---  
has_more| boolean| 是否更多  
start_from| string| 分页参数  
op_records| list<object>| 操作记录  
total| int64| 总数  
err| object| 请求成功时返回空值，请求失败时返回实际错误信息。  
err_msg| string| 请求成功时返回空值，请求失败时返回实际错误信息。  
err_code| int32| 请求成功时返回空值，请求失败时返回实际错误信息。  
  
​

请求示例​

获取工作项下所有操作记录

获取工作项下指定操作记录

​

JSON

复制

{​

"project_key": "68382b399de4b0ec6c5axxxx",​

"work_item_ids": [643711xxxx]​

}

​

​

返回示例​

获取工作项下所有操作记录

获取工作项下指定操作记录

无操作记录

错误返回示例

​

JSON

复制

{​

"err": {},​

"err_code": 0,​

"err_msg": "",​

"data": {​

"has_more": false, // 是否更多​

"start_from": "",​

"op_records": [​

{​

"project_key": "68382b399de4b0ec6c5axxxx",//空间key​

"operation_time": 1761554393000,//操作时间​

"operator_type": "user",// 操作动作类型​

"operator": "749112601802809xxxx",// 操作人 user_key​

"work_item_type_key": "story",//空间类型​

"operation_type": "modify",// 操作者类型​

"work_item_id": 643711xxxx,// 工作项 ID​

"op_record_module": "field_mod",//操作模块，字段​

"record_contents": [//记录详情操作记录变更内容​

{​

"add": [],​

"delete": [],​

"old": [],​

"new": [​

"643622xxxx"​

],​

"object": {//变更主体对象​

"object_type": "field",​

"object_value": "field_4b512b"​

}​

}​

]​

},​

{​

"operation_type": "modify",​

"operation_time": 1761555118000,​

"operator": "749112601802809xxxx",​

"record_contents": [​

{​

"object": {​

"object_type": "field",​

"object_value": "field_b34565"​

},​

"old": [],​

"delete": [],​

"new": [​

"1"​

],​

"add": [],​

"belong_object": [// 变更对象所属对象​

{​

"object_type": "field",​

"object_value": "field_c9c844"​

}​

]​

},​

{​

"new": [​

"2"​

],​

"delete": [],​

"belong_object": [​

{​

"object_type": "field",​

"object_value": "field_c9c844"​

}​

],​

"object": {​

"object_type": "field",​

"object_value": "field_db0b07"​

},​

"old": [],​

"add": []​

}​

],​

"work_item_type_key": "story",​

"project_key": "68382b399de4b0ec6c5axxxx",​

"work_item_id": 643711xxxx,​

"operator_type": "user",​

"op_record_module": "field_mod"​

}​

]​

}​

}

​

​

错误码​

以下列出了该接口相关的错误码信息，若需查看更多通用错误码说明，参见 [Open API 错误码](../1p8d7djs/5aueo3jr)。​

​

err_code| err_msg| err.code| err.msg| 说明  
---|---|---|---|---  
20006| ErrAPIInvalidParam| 20006| Invalid Param| 参数填写错误  
20005| ErrAPIMissingParam| 20005| Missing Param| 未填写必填入参  
20013| ErrAPIInvalidTimeInterval| 20013| Invalid Time Interval| 时间区间不合法，最长支持7天  
  
​

上一篇

冻结/解冻工作项

下一篇

批量查询评审意见、评审结论
