状态流转

该接口用于流转一个状态流工作项实例到指定状态（状态流），同时更新节点信息，包括人员角色和表单信息等。对应的平台功能介绍，如缺陷实例的节点操作可参考​状态流转。对应的权限申请在权限管理-工作项实例分类下，相关功能介绍详见 ​权限管理。​

​

​​​

​

请求说明​

  * 请求方式：POST​



  * 请求地址：/open_api/:project_key/workflow/:work_item_type_key/:work_item_id/node/state_change​



请求参数​

Header​

接口调用的 Header 配置详见 [Header](../1p8d7djs/4bsmoql6#a8e43b86)。​

Path​

​

参数| 类型| 是否必须| 说明  
---|---|---|---  
project_key| string| 必须| 空间 ID（project_key），或者空间域名（simple_name）。

  * 空间 ID（project_key），在飞书项目空间双击空间名称获取。
  * 空间域名（simple_name），simple_name 一般在飞书项目空间 URL 中获取。例如空间 URL 为 “https://project.feishu.cn/doc/overview”，则 simple_name为 “doc”。

  
work_item_type_key| string| 必须| 工作项类型，系统自动生成，可通过[获取空间下工作项类型](../1p8d7djs/3pjp854w)接口获取。  
work_item_id| string| 必须| 工作项实例 ID，在工作项实例详情中，展开右上角 **··· > ID**获取。  
  
​

Body​

​

参数| 类型| 是否必须| 说明  
---|---|---|---  
transition_id| int64| 必须| 流转到下一状态的 ID，可通过[获取工作流详情](../1p8d7djs/5hcmcl04)接口查询状态流获取。  
fields| list<object>| 可选| 要更新的字段数组，仅能更新状态表单中的字段。  
role_owners| list<object>| 可选| 角色及负责人。  
  
​

返回参数​

​

参数| 类型| 说明  
---|---|---  
err| object| 请求成功时返回空值，请求失败时返回实际错误信息。  
err_msg| string| 请求成功时返回空值，请求失败时返回实际错误信息。  
err_code| int32| 请求成功时返回0，请求失败返回实际错误码。  
  
​

请求示例​

请求路径：POST /open_api/676e6839bd3a3bcba14b****/workflow/issue/12694****/node/state_change​

​

JSON

复制

{​

"transition_id":12345//状态id，仅状态流返回​

"role_owners": [​

{​

"owners": [],​

"role": "PM"​

}​

],​

"fields":[​

{​

"field_alias": "sentry_link",//字段对接标识​

"field_key": "field_658c22",//字段key​

"field_type_key": "text",//字段类型​

"field_value": "23333"//字段值​

}​

] ​

}

​

返回示例​

请求成功示例

请求失败示例

​

JSON

复制

{​

"data":{},​

"err": {},​

"err_msg": "",​

"err_code": 0​

}

​

​

错误码​

以下列出了该接口相关的错误码信息，若需查看更多通用错误码说明，参见 [Open API 错误码](../1p8d7djs/5aueo3jr)。​

​

err_code| err_msg| err.code| err.msg| 说明  
---|---|---|---|---  
10002| Illegal Operation| 10002| Illegal Operation| 检查实例状态与当前请求参数，当前请求的状态流转请求与实例状态不匹配  
20005| Missing Param| 20005| transition_id can't be null or 0| 检查请求体中的 transition_id 是否正确  
30005| WorkItem Not Found| 30005| WorkItem Not Found| 检查给定的实例 ID 是否存在对应实例。  
20090| Your request has been Intercept| 20090| Your request has been intercepted.| 检查空间中配置的插件拦截规则，当前请求触发的修改命中了插件拦截规则  
20038| Param missing| 20038| 状态必填-条件可见-开关(field_IcjjIfWw) Required| 检查并填写模板配置中状态流转表单的必填项  
20038| Required Field Is Not Set| 20038| 状态必填-条件可见-级联单选(field_nC6GnmBc) Required| 检查并填写模板配置中状态流转表单的必填项  
30009| Field Not Found| 30009| field_value_pairs field key :can not find field| 检查请求参数，确认被更新的字段在当前工作项类型上存在  
30012| State Not Found In Stateflow| 30012| {State %!s(MISSING) Not Found In State Flow:[systemEnded]}| 工作流模板信息错误，可在模板升级后重试  
50006| Failed to check field| 50006| Due to the administrator configuration update| 在fields中设置正确的字段更新值，当前请求中的选项值已经不存在或被禁用  
  
​

上一篇

节点完成/回滚

下一篇

获取指定节点/状态流转所需必填信息
